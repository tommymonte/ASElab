


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             asm, CODE, READONLY
    2 00000000                 EXPORT           check_fibonacci
    3 00000000         
    4 00000000         ; 1) salva i registri come input nei nuovi registri, da 
                       r4 in poi
    5 00000000         ;  NB: se hai più di 4 input il 5 devi salvarlo così:
    6 00000000         ;  LDRB R4, [R12]  
    7 00000000         
    8 00000000         ; 2) se devi caricare un vettore usa -->  LDR R6, [R0, R
                       4, LSL #2] 
    9 00000000         ;  R0 punta all'indirizzo base vettore
   10 00000000         ;  R4 è l'indice del vettore, R6 dove salvi il valore
   11 00000000         ;   LSL #2 shifta l'indirizzo base del vettore di 4 byte
                       
   12 00000000         
   13 00000000         ; 3) se devi verificare che un numero sia pari o dispari
                        usa
   14 00000000         ;  TST R4, #1
   15 00000000         ;  MOVEQ R5, #1 --> è pari
   16 00000000         ;   MOVNE R5, #0 --> dipari
   17 00000000         
   18 00000000         ; 4) se devi salvare un valore a un puntatore utilizza S
                       TRB R4, [R0]
   19 00000000         ;  R0 è il registro di input in cui viene passato il pun
                       tatore
   20 00000000         ;   R4 è il valore che vuoi salvare
   21 00000000         
   22 00000000         ; 5) se voglio fare abs(-2) devo fare:
   23 00000000         ;  check_abs CMP R0, #0
   24 00000000         ;    BLT abs
   25 00000000         ;   abs    RSB R0, R0, #0 --> rsb fa una reverse sub: 0 
                       - (-2) = +2
   26 00000000         ;     B check_abs
   27 00000000         
   28 00000000         
   29 00000000         ; R0 VETT
   30 00000000         ; R1 N elementi
   31 00000000         ; R2 M 
   32 00000000         ;  R3 VAL
   33 00000000         ;  LDRB R4, [R12]  ; boundary BOUNDARY è posizionato 16 
                       byte sopra SP (dopo 4 parametri * 4 byte ciascuno) BOUND
                       ARY
   34 00000000         
   35 00000000         
   36 00000000         check_fibonacci
                               PROC
   37 00000000 46EC            MOV              R12, SP
   38 00000002 E92D 4DF0       STMFD            SP!,{R4-R8,R10-R11,LR} ;SALVO R
                                                            EGISTRI VOLATILI
   39 00000006 F89C 4000       LDRB             R4, [R12]   ; boundary
   40 0000000A F04F 0500       MOV              R5, #0      ; index
   41 0000000E         
   42 0000000E         ; cerchiamo la prima posizione libera
   43 0000000E 428D    CHECK_FIRST
                               CMP              R5, R1
   44 00000010 D025            BEQ              NON_ACCETTABILE
   45 00000012 5D46            LDRB             R6, [R0, R5]
   46 00000014 2E00            CMP              R6, #0
   47 00000016 D002            BEQ              FREE_POS



ARM Macro Assembler    Page 2 


   48 00000018         
   49 00000018 F105 0501       ADD              R5, R5, #1  ; incremento index 
                                                            count
   50 0000001C E7F7            B                CHECK_FIRST
   51 0000001E         
   52 0000001E         FREE_POS
   53 0000001E F04F 0700       MOV              R7, #0
   54 00000022 F04F 0801       MOV              R8, #1
   55 00000026 F04F 0A00       MOV              R10, #0     ; INDICE PER M
   56 0000002A         
   57 0000002A 4592    CHECK_FIBO
                               CMP              R10, R2     ; CMP CON M
   58 0000002C D012            BEQ              ACCETTABILE ; SONO ARRIVATO A 1
                                                            4 VUOL DIRE CHE HO 
                                                            CONFRONTATO TUTTI I
                                                             VALORI QUINDI è AC
                                                            CETTABILE
   59 0000002E         
   60 0000002E         ; GUARDO SE VAL è ACCETTABILE
   61 0000002E         ; PRIMA GUARDO SE è UGUALE A UN NUMERO DELLA SERIE
   62 0000002E 42BB            CMP              R3, R7
   63 00000030 D015            BEQ              NON_ACCETTABILE
   64 00000032 4543            CMP              R3, R8
   65 00000034 D013            BEQ              NON_ACCETTABILE
   66 00000036 EBA3 0B07       SUB              R11, R3, R7
   67 0000003A         
   68 0000003A F1BB 0F00 
                       CHECK_BOUNDARY
                               CMP              R11, #0
   69 0000003E DB06            BLT              ABS
   70 00000040         
   71 00000040 45A3            CMP              R11, R4
   72 00000042 DD0C            BLE              NON_ACCETTABILE ; val <= bounda
                                                            ry --> fine
   73 00000044         
   74 00000044 F10A 0A02       ADD              R10, R10, #2
   75 00000048         
   76 00000048         ; AGGIORNO LA SERIE
   77 00000048         ; 0 1 --> 1 2 --> 3 5 --> 8 13 ...
   78 00000048 4447            ADD              R7, R7, R8
   79 0000004A 44B8            ADD              R8, R8, R7
   80 0000004C E7ED            B                CHECK_FIBO
   81 0000004E         
   82 0000004E F1CB 0B00 
                       ABS     RSB              R11, R11, #0
   83 00000052 E7F2            B                CHECK_BOUNDARY
   84 00000054         
   85 00000054         ACCETTABILE                          ;LSL R5, R5, #2
   86 00000054 4405            ADD              R5, R0, R5
   87 00000056 702B            STRB             R3, [R5]
   88 00000058         
   89 00000058 F04F 0001       MOV              R0, #1
   90 0000005C E002            B                FINE
   91 0000005E         
   92 0000005E F04F 0000 
                       NON_ACCETTABILE
                               MOV              R0, #0
   93 00000062 E7FF            B                FINE
   94 00000064         



ARM Macro Assembler    Page 3 


   95 00000064         
   96 00000064 E8BD 8DF0 
                       FINE    LDMFD            SP!,{R4-R8,R10-R11,PC} ;RIPRIST
                                                            INO REGISTRI VOLATI
                                                            LI
   97 00000068                 ENDP
   98 00000068                 END
Command Line: --debug --xref --diag_suppress=9931,A1950W --cpu=Cortex-M3 --depe
nd=.\objects\asm.d -o.\objects\asm.o -I.\Source\button_EXINT -I.\Source\CMSIS_c
ore -I.\Source\joystick -I.\Source\led -I.\Source\RIT -I.\Source\timer -I.\Sour
ce -I.\RTE\_SW_Debug -IC:\Users\HP\AppData\Local\Arm\Packs\ARM\CMSIS\6.1.0\CMSI
S\Core\Include -IC:\Users\HP\AppData\Local\Arm\Packs\Keil\LPC1700_DFP\2.7.2\Dev
ice\Include --predefine="__UVISION_VERSION SETA 541" --predefine="LPC175x_6x SE
TA 1" --predefine="_RTE_ SETA 1" --list=.\listings\asm.lst asm.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

ABS 0000004E

Symbol: ABS
   Definitions
      At line 82 in file asm.s
   Uses
      At line 69 in file asm.s
Comment: ABS used once
ACCETTABILE 00000054

Symbol: ACCETTABILE
   Definitions
      At line 85 in file asm.s
   Uses
      At line 58 in file asm.s
Comment: ACCETTABILE used once
CHECK_BOUNDARY 0000003A

Symbol: CHECK_BOUNDARY
   Definitions
      At line 68 in file asm.s
   Uses
      At line 83 in file asm.s
Comment: CHECK_BOUNDARY used once
CHECK_FIBO 0000002A

Symbol: CHECK_FIBO
   Definitions
      At line 57 in file asm.s
   Uses
      At line 80 in file asm.s
Comment: CHECK_FIBO used once
CHECK_FIRST 0000000E

Symbol: CHECK_FIRST
   Definitions
      At line 43 in file asm.s
   Uses
      At line 50 in file asm.s
Comment: CHECK_FIRST used once
FINE 00000064

Symbol: FINE
   Definitions
      At line 96 in file asm.s
   Uses
      At line 90 in file asm.s
      At line 93 in file asm.s

FREE_POS 0000001E

Symbol: FREE_POS
   Definitions
      At line 52 in file asm.s
   Uses
      At line 47 in file asm.s
Comment: FREE_POS used once
NON_ACCETTABILE 0000005E




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: NON_ACCETTABILE
   Definitions
      At line 92 in file asm.s
   Uses
      At line 44 in file asm.s
      At line 63 in file asm.s
      At line 65 in file asm.s
      At line 72 in file asm.s

asm 00000000

Symbol: asm
   Definitions
      At line 1 in file asm.s
   Uses
      None
Comment: asm unused
check_fibonacci 00000000

Symbol: check_fibonacci
   Definitions
      At line 36 in file asm.s
   Uses
      At line 2 in file asm.s
Comment: check_fibonacci used once
10 symbols
343 symbols in table
